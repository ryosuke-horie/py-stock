# ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Šã‚¬ã‚¤ãƒ‰

## ğŸ“‹ æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€py-stockãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®å…·ä½“çš„ãªã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¨æ¨å¥¨äº‹é …ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚

ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸çŠ¶æ³ï¼š**70.80%** ï¼ˆç›®æ¨™ï¼š75%ä»¥ä¸Šï¼‰

## ğŸ¯ å„ªå…ˆåº¦åˆ¥æ”¹å–„æˆ¦ç•¥

### 1. ğŸŸ¢ ç°¡å˜æ”¹å–„å¯¾è±¡ï¼ˆ80%ä»¥ä¸Šã®ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: 28ãƒ•ã‚¡ã‚¤ãƒ«

ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ—¢ã«é«˜ã„ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’é”æˆã—ã¦ãŠã‚Šã€æ¯”è¼ƒçš„ç°¡å˜ã«100%ã«è¿‘ã¥ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### æ”¹å–„æ‰‹æ³•
- **ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®è¿½åŠ **: å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆã®è¿½åŠ 
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ**: ä¾‹å¤–å‡¦ç†ã®ãƒ†ã‚¹ãƒˆè¿½åŠ 
- **æ¡ä»¶åˆ†å²ã®å®Œå…¨ã‚«ãƒãƒ¼**: if-elseæ–‡ã®å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ

#### å…·ä½“ä¾‹
```python
# ãƒ†ã‚¹ãƒˆä¸è¶³ä¾‹
def calculate_ratio(numerator: float, denominator: float) -> float:
    if denominator == 0:  # â† ã“ã®åˆ†å²ãŒãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„
        raise ValueError("Division by zero")
    return numerator / denominator

# è¿½åŠ ã™ã¹ããƒ†ã‚¹ãƒˆ
def test_calculate_ratio_zero_division():
    with pytest.raises(ValueError, match="Division by zero"):
        calculate_ratio(10, 0)
```

### 2. ğŸŸ¡ ä¸­ç¨‹åº¦æ”¹å–„å¯¾è±¡ï¼ˆ60-79%ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: 7ãƒ•ã‚¡ã‚¤ãƒ«

#### æ”¹å–„æ‰‹æ³•
- **è¨­å®šãƒ‘ã‚¿ãƒ¼ãƒ³ã®å¤šæ§˜åŒ–**: ç•°ãªã‚‹è¨­å®šå€¤ã§ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
- **ãƒ¢ãƒƒã‚¯ã®æ´»ç”¨**: å¤–éƒ¨ä¾å­˜é–¢ä¿‚ã®ãƒ¢ãƒƒã‚¯åŒ–
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãƒ†ã‚¹ãƒˆ**: è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åŠ¹ç‡çš„ã«ãƒ†ã‚¹ãƒˆ

#### å…·ä½“ä¾‹
```python
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãƒ†ã‚¹ãƒˆã®æ´»ç”¨
@pytest.mark.parametrize("input_value,expected", [
    (100, True),
    (0, False),
    (-50, False),
    (None, False),
])
def test_is_positive(input_value, expected):
    assert is_positive(input_value) == expected
```

### 3. ğŸ“š examplesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç‰¹æ®Šå‡¦ç†

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: 7ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå¹³å‡ã‚«ãƒãƒ¬ãƒƒã‚¸: ä½ï¼‰

examplesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯æ•™è‚²ãƒ»ãƒ‡ãƒ¢ç”¨é€”ã®ãŸã‚ã€ä½ã‚«ãƒãƒ¬ãƒƒã‚¸ã¯è¨±å®¹ã•ã‚Œã¾ã™ãŒã€ä»¥ä¸‹ã®ç‚¹ã§æ”¹å–„å¯èƒ½ã§ã™ï¼š

#### æ”¹å–„æ‰‹æ³•
- **åŸºæœ¬å‹•ä½œã®ç¢ºèªãƒ†ã‚¹ãƒˆ**: mainé–¢æ•°ãŒæ­£å¸¸ã«å®Ÿè¡Œã§ãã‚‹ã“ã¨ã®ç¢ºèª
- **é‡è¦ãƒ­ã‚¸ãƒƒã‚¯ã®æŠ½å‡º**: å†åˆ©ç”¨å¯èƒ½ãªéƒ¨åˆ†ã‚’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåŒ–ã—ã¦ãƒ†ã‚¹ãƒˆ
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼**: å¿…è¦ãªè¨­å®šé …ç›®ãŒæƒã£ã¦ã„ã‚‹ã‹ã®ç¢ºèª

## ğŸ› ï¸ å…·ä½“çš„æ”¹å–„æ‰‹é †

### Step 1: ç°¡å˜æ”¹å–„å¯¾è±¡ã‹ã‚‰é–‹å§‹

1. ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã§80%ä»¥ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®š
2. æœªã‚«ãƒãƒ¼ãƒ©ã‚¤ãƒ³ï¼ˆred linesï¼‰ã‚’ç¢ºèª
3. ä¸è¶³ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç‰¹å®š
4. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ 

### Step 2: ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã®æ´»ç”¨

#### pytest-cov ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ´»ç”¨
```bash
# æœªã‚«ãƒãƒ¼è¡Œã®è©³ç´°è¡¨ç¤º
uv run pytest --cov=src --cov-report=term-missing

# HTML ãƒ¬ãƒãƒ¼ãƒˆã§è¦–è¦šçš„ç¢ºèª
uv run pytest --cov=src --cov-report=html
open htmlcov/index.html
```

#### coverage.py ã®æ´»ç”¨
```bash
# ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã®è©³ç´°åˆ†æ
uv run coverage report --show-missing src/technical_analysis/indicators.py
```

### Step 3: ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¨™æº–åŒ–

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆã®æ¨™æº–ãƒ‘ã‚¿ãƒ¼ãƒ³
```python
def test_function_with_invalid_input():
    """ç„¡åŠ¹ãªå…¥åŠ›ã«å¯¾ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ãƒ†ã‚¹ãƒˆ"""
    with pytest.raises(ValueError, match="Expected error message"):
        target_function(invalid_input)

def test_function_with_none_input():
    """Noneå…¥åŠ›ã«å¯¾ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ãƒ†ã‚¹ãƒˆ"""
    with pytest.raises(TypeError):
        target_function(None)
```

#### æ¡ä»¶åˆ†å²ãƒ†ã‚¹ãƒˆã®æ¨™æº–ãƒ‘ã‚¿ãƒ¼ãƒ³
```python
def test_conditional_logic_all_branches():
    """ã™ã¹ã¦ã®æ¡ä»¶åˆ†å²ã‚’ãƒ†ã‚¹ãƒˆ"""
    # Trueåˆ†å²
    result_true = target_function(condition_true_input)
    assert result_true == expected_true_result
    
    # Falseåˆ†å²
    result_false = target_function(condition_false_input)
    assert result_false == expected_false_result
    
    # ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
    result_edge = target_function(edge_case_input)
    assert result_edge == expected_edge_result
```

## ğŸ¨ ãƒ†ã‚¹ãƒˆä½œæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ†ã‚¹ãƒˆã®å‘½åè¦å‰‡
```python
def test_[function_name]_[scenario]_[expected_result]():
    """æ˜ç¢ºã§èª¬æ˜çš„ãªãƒ†ã‚¹ãƒˆåã‚’ä½¿ç”¨"""
    pass

# è‰¯ã„ä¾‹
def test_calculate_moving_average_with_valid_data_returns_correct_values():
    pass

def test_calculate_moving_average_with_insufficient_data_raises_value_error():
    pass
```

### 2. AAA ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨
```python
def test_example():
    # Arrange: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
    input_data = [1, 2, 3, 4, 5]
    expected_result = 3.0
    
    # Act: ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®å®Ÿè¡Œ
    result = calculate_average(input_data)
    
    # Assert: çµæœã®æ¤œè¨¼
    assert result == expected_result
```

### 3. ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã®æ´»ç”¨
```python
@pytest.fixture
def sample_stock_data():
    """ãƒ†ã‚¹ãƒˆç”¨ã®æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’æä¾›"""
    return pd.DataFrame({
        'close': [100, 105, 102, 108, 110],
        'volume': [1000, 1200, 800, 1500, 900]
    })

def test_technical_indicator(sample_stock_data):
    result = calculate_rsi(sample_stock_data)
    assert len(result) == len(sample_stock_data)
```

## ğŸš« ã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Šã‚’å›°é›£ã«ã™ã‚‹è¦å› 

### 1. å¤–éƒ¨ä¾å­˜é–¢ä¿‚
- **å•é¡Œ**: APIã‚³ãƒ¼ãƒ«ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡
- **è§£æ±ºç­–**: ãƒ¢ãƒƒã‚¯ã¨ã‚¹ã‚¿ãƒ–ã®æ´»ç”¨

```python
@patch('module.external_api_call')
def test_function_with_external_dependency(mock_api):
    mock_api.return_value = mock_response
    result = function_under_test()
    assert result == expected_result
```

### 2. è¤‡é›‘ãªè¨­å®šä¾å­˜
- **å•é¡Œ**: å¤šæ•°ã®è¨­å®šé …ç›®ã«ä¾å­˜ã™ã‚‹å‡¦ç†
- **è§£æ±ºç­–**: è¨­å®šã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®æ´»ç”¨

### 3. æ™‚é–“ä¾å­˜å‡¦ç†
- **å•é¡Œ**: ç¾åœ¨æ™‚åˆ»ã‚„æ—¥ä»˜ã«ä¾å­˜ã™ã‚‹å‡¦ç†
- **è§£æ±ºç­–**: æ™‚é–“ã®ãƒ¢ãƒƒã‚¯åŒ–

```python
@patch('module.datetime')
def test_time_dependent_function(mock_datetime):
    mock_datetime.now.return_value = datetime(2023, 1, 1, 12, 0, 0)
    result = time_dependent_function()
    assert result == expected_result
```

## ğŸ“Š ç¶™ç¶šçš„æ”¹å–„

### 1. ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- CI/CDã§ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯
- æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®ã‚«ãƒãƒ¬ãƒƒã‚¸è¦ä»¶è¨­å®š
- å®šæœŸçš„ãªã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª

### 2. ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™è¨­å®š
- **çŸ­æœŸç›®æ¨™**: 75% (ç¾åœ¨70.80%ã‹ã‚‰+4.2%å‘ä¸Š)
- **ä¸­æœŸç›®æ¨™**: 80% 
- **é•·æœŸç›®æ¨™**: 85% (examplesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé™¤ã)

### 3. ãƒãƒ¼ãƒ å†…ã§ã®å…±æœ‰
- ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®å®šæœŸçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼
- ä½ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®å„ªå…ˆçš„ãªæ”¹å–„
- ãƒ†ã‚¹ãƒˆä½œæˆã®ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰

## ğŸ”§ è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«

### ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ´»ç”¨
```bash
# åˆ†æãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
uv run python docs/testing/coverage_analyzer.py

# ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
# - docs/testing/coverage_analysis_report.md
# - docs/testing/coverage_data.json
```

### ç¶™ç¶šçš„ãªç›£è¦–
```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯ã®è‡ªå‹•åŒ–
uv run pytest --cov=src --cov-fail-under=70
```

## ğŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼š

- [ ] æ­£å¸¸ç³»ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- [ ] ç•°å¸¸ç³»ï¼ˆã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ï¼‰ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- [ ] å¢ƒç•Œå€¤ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- [ ] ã™ã¹ã¦ã®æ¡ä»¶åˆ†å²ãŒã‚«ãƒãƒ¼ã•ã‚Œã¦ã„ã‚‹
- [ ] å¤–éƒ¨ä¾å­˜é–¢ä¿‚ãŒé©åˆ‡ã«ãƒ¢ãƒƒã‚¯åŒ–ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ†ã‚¹ãƒˆåãŒèª¬æ˜çš„ã§ã‚ã‚‹
- [ ] AAA ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã£ã¦ã„ã‚‹
- [ ] ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãŒæ˜ç¢ºã§ã‚ã‚‹

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã£ã¦ç¶™ç¶šçš„ã«ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’æ”¹å–„ã—ã¦ã„ãã“ã¨ã§ã€ã‚ˆã‚Šå“è³ªã®é«˜ã„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’é–‹ç™ºã§ãã¾ã™ã€‚